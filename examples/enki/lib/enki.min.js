/*! enki 2015-04-07 */
!function(){"use strict";var a={};window.enki=a;var b=[],c=!1,d=[],e={},f=[],g=function(a){var b=function(b){a.value!==b&&(a.notifications.forEach(function(c){c(b,a.value)}),a.value=b,a.computableNotifications.forEach(function(c){c(b,a.value)}))};return b},h=function(a){var d=function(){return c&&b.push(a),a.value};return d},i=function(a){if(!a.__values__){Object.defineProperty(a,"__values__",{enumerable:!1,configurable:!1,writable:!1,value:{}});for(var b in a)a.__values__[b]=a.__values__[b]||{}}},j=function(a,b,c){return c=c||b.split("."),1===c.length?a[c[0]]:j(a[c[0]],"",c.slice(1))};a.watch=function(b){i(b);var c=b.__values__;for(var e in b)"function"!=typeof b[e]&&(c[e].notifications=c[e].notifications||[],c[e].computableNotifications=c[e].computableNotifications||[],c[e].value=b[e],Object.defineProperty(b,e,{set:g(c[e]),get:h(c[e])}),b[e]=c[e].value,"object"==typeof b[e]&&a.watch(b[e]));b.__values__.extensions&&b.__values__.extensions.forEach(function(b){a.addComputable(b.model,b.propertyName,b.func)}),d.length>0&&d.forEach(function(a){a.onWatch&&a.onWatch(b)})},a.addListener=function(b,c,d){var e=c.split(".");e.length>1?a.addListener(b[e[0]],c.replace(e[0]+".",""),d):b.__values__[c].notifications.push(d)};var k=function(a,b){try{for(var c=0;c<a.length;c++){var d=a[c],e=d.getAttribute("data-bind");if(e){var f=m(e);o(d,f,b)}}l(b)}catch(g){var h=new Error("Invalid binding: "+d.getAttribute("data-bind")+". "+g);throw h}};a.bindDocument=function(b,c){try{var d="function"==typeof b?b():b;a.watch(d);var e=document.querySelectorAll((c?"#"+c+" ":"")+'[data-bind*="if"]');k(e,d),e=document.querySelectorAll((c?"#"+c+" ":"")+'[data-bind*="foreach"]'),k(e,d),e=document.querySelectorAll((c?"#"+c+" ":"")+"[data-bind]"),k(e,d)}catch(f){s(f)}},a.addNotification=function(b,c,d){b.__values__||a.watch(b),b.__values__[c].notifications.push(d)},a.addCustomBinding=function(a,b){b.isCustom=!0,p[a]=b},a.removeCustomBinding=function(a){p[a]&&p[a].isCustom&&delete p[a]},a.addCustomConverter=function(a,b){b.isCustom=!0,q[a]=b},a.removeCustomConverter=function(a){q[a]&&q[a].isCustom&&delete q[a]},a.extend=function(a,b,c){i(a),a.__values__.extensions=a.__values__.extensions||[],a.__values__.extensions.push({model:a,propertyName:b,func:c})},a.addComputable=function(a,d,e){Object.defineProperty(a,d,{enumerable:!0,configurable:!0,get:function(){return e(a)}}),c=!0,a[d],c=!1;var f=a.__values__;f[d]=f[d]||{},f[d].notifications=f[d].notifications||[],b.forEach(function(b){b.computableNotifications.push(function(){f[d].notifications.forEach(function(b){b(e(a))})})}),b=[]};var l=function(a){for(var b in a)a.__values__[b]&&a.__values__[b].notifications&&a.__values__[b].notifications.forEach(function(c){c(a[b])})},m=function(a){try{var b=a.replace(/[.\w\d-]+/g,'"$&"');return JSON.parse("{"+b+"}")}catch(c){var d=new Error("Invalid syntax in binding: "+a);throw d}},n=function(a,b,c){"string"==typeof b&&(a.__values__[b].elements=a.__values__[b].elements||[],a.__values__[b].elements.push(c))},o=function(b,c,d){var e=function(a,b){if("string"!=typeof b)return{value:a[b],model:a,name:b};var c=b.split(".");if(1===c.length)return{value:a[c[0]],model:a,name:c[0]};var d=a[c[0]];return e(d,c.splice(1))};for(var f in c)if(p[f]&&!b.allreadyBound){var g=c[f],h=e(d,g),i={element:b,propertyValue:h.value,viewModel:h.model,propertyName:h.name};if(p[f].init&&p[f].init(i),p[f].update)if("object"==typeof g&&g.converter){var j=g;if(!q[j.converter]){var k=new Error("No such converter: "+j.converter);throw k}a.addNotification(d,j.value,function(){i.propertyValue=q[j.converter].toView.call(a,d[j.value],j.parameter),p[f].update(i)})}else p[f].update(i),a.addNotification(i.viewModel,i.propertyName,function(a){i.propertyValue=a,p[f].update(i)});n(i.viewModel,i.propertyName,b)}},p={click:{init:function(a){if("function"!=typeof a.propertyValue)throw new Error(a.propertyValue+" is not a function");a.element.onclick=function(b){a.propertyValue(b,a.viewModel)}}},text:{update:function(a){a.element.innerHTML=a.propertyValue}},value:{init:function(a){a.element.onchange=function(){a.viewModel[a.propertyName]=a.element.value}},update:function(a){a.element.value=a.propertyValue}},liveValue:{init:function(a){a.element.onkeyup=function(){a.viewModel[a.propertyName]=a.element.value}},update:function(a){a.element.value=a.propertyValue}},template:{init:function(a){var b=document.getElementById(a.propertyName.name).innerHTML;a.element.innerHTML=b,k(a.element.childNodes,a.viewModel[a.propertyName.model])}},foreach:{init:function(a){var b=a.element.innerHTML;a.element.innerHTML="",a.element.allreadyBound=!0;var c=document.createElement("div"),d=document.createDocumentFragment(),e=a.propertyValue;e.forEach(function(a){for(c.innerHTML=b,k(c.childNodes,a);c.childNodes.length;)c.childNodes[0].allreadyBound=!0,d.appendChild(c.childNodes[0])}),a.element.appendChild(d)}},visible:{init:function(b){var c=b.element,d="";a.addListener(b.viewModel,b.propertyName,function(a){a?c.style.display=d:(d="none"===c.style.display?"":c.style.display,c.style.display="none")})}},attributes:{init:function(b){var c=b.propertyName;for(var d in c)a.addListener(b.viewModel,c[d],function(a){b.element.setAttribute(d,a)})}},cssClass:{init:function(b){var c=b.propertyName;for(var d in c)a.addListener(b.viewModel,c[d],function(a){a?b.element.classList.add(d):b.element.classList.remove(d)})}},event:{init:function(a){var b=a.propertyName;for(var c in b){var d=function(d){a.viewModel[b[c]](d,a.viewModel)};a.element[c]=d}}},checked:{init:function(a){a.element.onclick=function(){a.viewModel[a.propertyName]=a.element.checked}},update:function(a){a.element.checked=a.propertyValue}},"if":{init:function(b){b.element.allreadyBound=!0;var c=b.element.innerHTML;b.element.innerHTML="",a.addListener(b.viewModel,b.propertyName,function(a){a?(b.element.innerHTML=c,k(b.element.childNodes,a)):b.element.innerHTML=""})}},component:{init:function(b){var c={};for(var d in b.propertyName)"name"!==d&&(c[d]=j(b.viewModel,d));a.watch(c);var f=e[b.propertyName.name](c);b.element.innerHTML=document.getElementById(f.template).innerHTML,k(b.element.childNodes,f.viewModel)}}},q={fixedPrecision:{toView:function(a,b){return a.toFixed(b)}},shortDate:{toView:function(a){return a.toLocaleDateString()}},time:{toView:function(a){return a.toLocaleTimeString()}}},r=function(a){return!a.__values__&&i(a),a.__values__};a.addPlugin=function(a){var b={initValues:i,logError:s,bindElements:k,getMetadata:r};d.push(a),a.init&&a.init(b)},a.registerComponent=function(a,b){e[a]=b},a.removeComponent=function(a){delete e[a]},a.exceptions={addListener:function(a){f.push(a)},clearListeners:function(){f=[]},shouldHideErrors:!1};var s=function(b){var c={message:b.message,userAgent:window.navigator.userAgent,stackTrace:b.stack,original:b,url:window.document.URL};if(f.forEach(function(a){a&&a(c)}),!a.exceptions.shouldHideErrors){var d=new Error("Enki encountered a problem: "+c.message);throw d.originalError=b,d}}}();